/*
 Creative Commons Attribution-ShareAlike 3.0
 @version 1.0.7
*/
(function(c){function g(a,b){e.image.lowResolution=c("img:first",a);this.element=a;this.settings=c.extend(e,b);this._defaults=e;this._name=f;this.init()}var f="easyZoom",e={image:{lowResolution:null,properties:{relation:{height:null,width:null}}},notifications:{error:"There has been a problem with loading the image!",loading:"Loading high resolution image..."},resource:{image:new Image,isLoaded:!1,reference:null},selector:{preview:"#preview-zoom",window:"#window-zoom"}};g.prototype={init:function(a){this.settings.resource.reference=
"undefined"!=typeof a?a:c(this.element).attr("data-image");this.reset().attachEventListener()},adjustHighResolutionImage:function(a,b){c(this.settings.selector.window).children("img:first").css({left:a,top:b});return this},attachEventListener:function(){var a=this;c(this.element).on({mouseover:function(){a.start()},mousemove:function(b){a.recognizeMouseMovement(b)},mouseout:function(b){a.previewRemainsInScope(b)||a.fadeOut()}});return this},calculateRelationOfImageGeometry:function(a){this.settings.image.properties.relation.width=
a.width/this.settings.image.lowResolution.width();this.settings.image.properties.relation.height=a.height/this.settings.image.lowResolution.height()},deferredFadeOut:function(a){var b=this;setTimeout(function(){b.fadeOut()},a)},detachEventListener:function(){c(this.element).off();return this},fadeOut:function(){c(this.settings.selector.preview).fadeOut();c(this.settings.selector.window).fadeOut();return this},getPropertiesOfPreview:function(a){var b={height:c(this.settings.selector.window).height()/
this.settings.image.properties.relation.height,width:c(this.settings.selector.window).width()/this.settings.image.properties.relation.width},d=c(this.settings.image.lowResolution).offsetParent().offset();return c.extend(b,{left:a.pageX-b.width/2-d.left,top:a.pageY-b.height/2-d.top})},modifyCursorAppearance:function(a){c(this.element).css("cursor",a);return this},previewRemainsInScope:function(a){var b=c(this.settings.image.lowResolution);return a.pageX<b.offset().left||a.pageX>b.offset().left+b.width()||
a.pageY<b.offset().top||a.pageY>b.offset().top+b.height()?!1:!0},recognizeMouseMovement:function(a){if(this.settings.resource.isLoaded)if(this.previewRemainsInScope(a)){var b=(a.pageX-this.settings.image.lowResolution.offset().left)*this.settings.image.properties.relation.width-c(this.settings.selector.window).width()/2,d=(a.pageY-this.settings.image.lowResolution.offset().top)*this.settings.image.properties.relation.height-c(this.settings.selector.window).height()/2;this.adjustHighResolutionImage(-b,
-d).showZoomWindow().showPreview(this.getPropertiesOfPreview(a))}else this.fadeOut()},reset:function(){this.settings.resource.isLoaded=!1;return this.fadeOut().detachEventListener()},showErrorNotification:function(){this.modifyCursorAppearance("auto").showNotification(this.settings.notifications.error).deferredFadeOut(2E3)},showNotification:function(a){c(this.settings.selector.window).fadeIn().text(a);return this},showPreview:function(a){c(this.settings.selector.preview).css(a).fadeIn()},showZoomWindow:function(){c(this.settings.selector.window).html(this.settings.resource.image).fadeIn();
return this},start:function(){this.modifyCursorAppearance("auto");this.settings.resource.isLoaded?this.showZoomWindow():(this.modifyCursorAppearance("progress"),this.showNotification(this.settings.notifications.loading),this.waitUntilResourceIsLoaded(this.settings.resource.reference))},waitUntilResourceIsLoaded:function(a){var b=this;this.settings.resource.image.src=a;c(this.settings.resource.image).load(function(){b.settings.resource.isLoaded=!0;b.calculateRelationOfImageGeometry(this);b.start()}).error(function(){b.showErrorNotification()});
return b}};c.fn[f]=function(a){return this.each(function(){c.data(this,f,new g(this,a))})}})(jQuery);
